<!DOCTYPE html>
<html>
  <head>
    <link rel="canonical" href="https://3618321s.github.io/Bonus/" />
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=0"
    />

    <title>好過年年好過過好年 - Let's Start</title>
    <meta
      name="description"
      content="參考午餐吃什麼？用抽獎方式來決定今天的午餐吧！由 August 開發，以 Google Sheets 當資料庫，介接 Google Map Embed API，輕鬆好管理。"
    />
    <link
      rel="shortcut icon"
      href="https://letswritetw.github.io/letswritetw/dist/img/logo_512.png"
    />
    <meta
      property="og:url"
      content="https://letswritetw.github.io/letswrite-food-check/"
    />
    <meta property="og:site_name" content="Let's Write" />
    <meta property="og:title" content="好過年年好過過好年 - Let's Start" />
    <meta
      property="og:description"
      content="參考午餐吃什麼？用抽獎方式來決定今天的午餐吧！由 August 開發，以 Google Sheets 當資料庫，介接 Google Map Embed API，輕鬆好管理。"
    />
    <meta
      property="og:image"
      content="https://letswritetw.github.io/letswrite-food-check/assets/img/bg-food.jpg"
    />
    <meta itemprop="name" content="好過年年好過過好年 - Let's Start" />
    <meta
      itemprop="description"
      content="參考午餐吃什麼？用抽獎方式來決定今天的午餐吧！由 August 開發，以 Google Sheets 當資料庫，介接 Google Map Embed API，輕鬆好管理。"
    />
    <meta
      itemprop="image"
      content="https://letswritetw.github.io/letswrite-food-check/assets/img/bg-food.jpg"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/normalize/7.0.0/normalize.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="assets/css/main.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Google Tag Manager-->
    <!-- <script>
		(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
		new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
		j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
		'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-PGQ9WQT');
	</script> -->
  </head>
  <body>
    <!-- Google Tag Manager (noscript)-->
    <!-- <noscript>
      <iframe
        src="https://www.googletagmanager.com/ns.html?id=GTM-PGQ9WQT"
        height="0"
        width="0"
        style="display: none; visibility: hidden"
      ></iframe>
    </noscript> -->

    <!--  背景圖  -->
    <main class="full-block">
      <!--  主要內容  -->
      <div class="main-block">
        <!--  顯示區塊  -->
        <section class="god">
          <h1>
            <span class="wrap">
              <span>抽起來!!!</span>
            </span>
          </h1>
        </section>

        <!--  按鈕  -->
        <section class="btns">
          <!--  start  -->
          <a class="btn-start" href="#">
            <span class="line top -h"></span>
            <span class="line right -v"></span>
            <span class="line bottom -h"></span>
            <span class="line left -v"></span>
          </a>
        </section>

        <div class="container" style="margin-top: 30px">
          <div class="row">
            <div class="col-sm-4">
              <div class="container">
                <ul class="trainList"></ul>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="container">
                <ul class="trainList1"></ul>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="container">
                <ul class="trainList2"></ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!--  github link  -->
    <div class="github">
      <a href="https://github.com/letswritetw/letswrite-food-check">
        <i class="fa fa-github" aria-hidden="true"></i>
      </a>
    </div>

    <!--  for search  -->
    <!-- <div class="search-only">
		<h2>
			午餐吃什麼選擇器 Google Excel、Google Map Embed API
		</h2>
		<p>
			午餐吃什麼？用抽獎方式來決定今天的午餐吧！由 August 開發，以 Google Excel 當資料庫，介接 Google Map Embed API，輕鬆好管理。
		</p>
	</div> -->

    <script>
      // Maps Embed API、Google Sheets API 的 金鑰
      // 可由 https://console.developers.google.com/apis 申請
      const embedApiKey = "AIzaSyDXC-ahKOIns3_qjoh9y3XXYgs3eFt7XuY";

      const uri =
        "https://sheets.googleapis.com/v4/spreadsheets/1BrBZECi3UmUaPle0M75xc99RYb5dXuZmmUrM6j4aNSY/values/BONUS?alt=json&key=" +
        embedApiKey;
      //https://docs.google.com/spreadsheets/d/1BrBZECi3UmUaPle0M75xc99RYb5dXuZmmUrM6j4aNSY/edit#gid=678916723
      const duration = 2000; // 拉霸效果執行多久

      fetch(uri)
        .then((res) => res.json())
        .then((data) => {
          // let vages = []; // 數字0 未抽過
          // let meats = []; // 數字1 抽過
          let all = []; //全部
          let pass = []; //抽過
          let result = []; //沒抽過

          // 分葷、素，塞入陣列
          const d = data.values,
            len = d.length;

          // for (let i = 1; i < len; i++) {
          //   d[i][2] === "0" ? vages.push(d[i][1]) : meats.push(d[i][1]);
          // }

          //塞入全部陣列中
          for (let j = 1; j < len; j++) {
            all.push(d[j][1]);
          }

          //所有金額都顯示
              var trainList = document.querySelector(".trainList");
              //跑迴圈將li新增進去
              for (let z = 0; z < all.length; z++) {
                var li = document.createElement("li");
                li.innerHTML =
                  "<div><span id=" + z + ">" + all[z] + "</span></div>";
                trainList.appendChild(li);
              }

          // 點擊按鈕後執行
          let r; // 亂數
          let max, min; // 陣列的最大、小值
          let txt; // 結果

          // 按鈕
          const btn = document.querySelector(".btn-start");

          btn.addEventListener(
            "click",
            (e) => {
              e.preventDefault();

              // 選店家 fn
              const chooseShop = (toggle) => {
                // 取亂數 fn
                r = () => {
                  max = toggle.length - 1;
                  min = 0;
                  return Math.floor(Math.random() * (max - min + 1)) + min;
                };

                // 清空、插入選項
                let input = document.querySelector(".wrap");
                input.innerHTML = "";
                for (let i = 0; i < toggle.length; i++) {
                  input.insertAdjacentHTML(
                    "beforeend",
                    "<span>" + toggle[i] + "</span>"
                  );
                }

                // 禁止按鈕再被點擊
                e.target.classList.add("not-allow");

                // 加入動畫 class name
                const list = document.querySelectorAll(".wrap > span");
                Array.prototype.forEach.call(list, (l) =>
                  l.classList.add("span-" + (toggle.length - 1))
                );

                // 亂數決定中選店家
                txt = toggle[r()];
                list[0].innerText = txt;

                pass.push(txt);

                // 移除動畫
                setTimeout(() => {
                  // 停止拉霸動畫
                  Array.prototype.forEach.call(list, (l) =>
                    l.removeAttribute("class")
                  );
                  //按鈕恢復
                  e.target.classList.remove("not-allow");
                  //顯示被選中的值
                  var trainList1 = document.querySelector(".trainList1");
                  //跑迴圈將li新增進去
                  var li = document.createElement("li");
                  li.innerHTML = "";
                  for (let a = 0; a < pass.length; a++) {
                    li.innerHTML =
                      "<div><span id=" + a + ">" + pass[a] + "</span></div>";
                    trainList1.appendChild(li);
                  }

                  //整理原本資料
                  result = all
                    .filter((e) => {
                      return pass.indexOf(e) === -1;
                    })
                    .concat(
                      pass.filter((f) => {
                        return all.indexOf(f) === -1;
                      })
                    );

                  // //跑迴圈將li新增進去
                  // for (let z = 0; z < result.length; z++) {
                  //   var li = document.createElement("li");
                  //   li.innerHTML =
                  //     "<div><span id=" + z + ">" + result[z] + "</span></div>";
                  //   trainList.appendChild(li);
                  // }
                }, duration);
              };              

              if (pass.length == 0) {
                //開始執行
                chooseShop(all);
              } else if (result.length == 0) {
                btn.disabled = false;
              } else {
                //開始執行
                chooseShop(result);
              }
            },
            false
          );
        });
    </script>
  </body>
</html>
